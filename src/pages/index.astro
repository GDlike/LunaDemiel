---
import Layout from '../layouts/Layout.astro';
import HeroShell from '../components/HeroShell.astro';
import BentoItem from '../components/BentoItem.astro';
import InfoPanel from '../components/InfoPanel.astro';
import SchemaOrg from '../components/SchemaOrg.astro';
import ShareButtons from '../components/ShareButtons.astro';
---

<Layout title="Borja & Susan | Luna de Miel Indonesia">

  <HeroShell slot="hero" variant="index">

    <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-black/40 backdrop-blur-md text-amber-300 text-xs font-bold border border-white/10 mb-6 animate-pulse shadow-lg">
      <span>‚úàÔ∏è 22 JULIO 2026 ‚Äî LA CUENTA ATR√ÅS</span>
    </div>

    <div id="countdown" class="grid grid-cols-4 gap-3 md:gap-6 w-full max-w-3xl mb-8" role="timer" aria-live="polite" aria-label="Cuenta atr√°s hasta el viaje">
      <div class="countdown-box"><span id="days" aria-label="D√≠as restantes">00</span><span class="label">D√≠as</span></div>
      <div class="countdown-box"><span id="hours" aria-label="Horas restantes">00</span><span class="label">Horas</span></div>
      <div class="countdown-box"><span id="minutes" aria-label="Minutos restantes">00</span><span class="label">Min</span></div>
      <div class="countdown-box"><span id="seconds" aria-label="Segundos restantes">00</span><span class="label">Seg</span></div>
    </div>

    <div class="flex flex-wrap justify-center gap-4 animate-fade-in">
      <div class="bg-white/5 backdrop-blur-md border border-white/10 px-4 py-2 rounded-2xl flex items-center gap-3 shadow-xl" aria-live="polite" aria-atomic="true">
        <span class="text-2xl" id="weather-emoji" aria-hidden="true">üå°Ô∏è</span>
        <div class="text-left">
          <p class="text-[10px] text-zinc-400 uppercase font-bold leading-none mb-1">Ubud ahora</p>
          <p class="text-white font-black leading-none" id="weather-temp" aria-label="Temperatura en Ubud">Cargando...</p>
        </div>
      </div>

      <div class="bg-white/5 backdrop-blur-md border border-white/10 px-4 py-2 rounded-2xl flex items-center gap-3 shadow-xl" aria-live="polite" aria-atomic="true">
        <span class="text-2xl" aria-hidden="true">üïí</span>
        <div class="text-left">
          <p class="text-[10px] text-zinc-400 uppercase font-bold leading-none mb-1">Hora Local</p>
          <p class="text-white font-black leading-none" id="local-time" aria-label="Hora local en Bali">00:00:00</p>
        </div>
      </div>
    </div>
  </HeroShell>

  <div class="relative z-20 pt-20 md:pt-32 flex flex-col pb-20">
    <div class="text-center py-0 my-0">
      <h2 class="text-5xl md:text-7xl font-[900] text-white leading-none">
        Nuestros<br/>
        <span class="text-amber-500">Alojamientos:</span>
      </h2>
    </div>

    <div class="flex flex-col gap-32 md:gap-40 mt-12 px-4 max-w-7xl mx-auto">

      <section class="flex flex-col md:flex-row items-center gap-12 md:gap-20 fade-in-on-scroll">
        <div class="w-full md:w-1/2 space-y-8">
          <div>
            <span class="text-amber-400 font-bold tracking-widest uppercase text-sm mb-2 block">22-25 JUL ¬∑ 3 NOCHES</span>
            <h2 class="text-4xl md:text-5xl font-[900] text-white mb-6 leading-tight">Selva de Ubud üêí</h2>
            <p class="text-zinc-400 text-lg leading-relaxed mb-8">
              Empezamos fuerte en el <strong>The Sebali Resort</strong>. Piscina privada y vistas a la selva.
            </p>
          </div>

          <div class="grid gap-4">
            <InfoPanel title="Cuidado con los Monos" text="En el 'Monkey Forest' les encantan las cosas brillantes. ¬°Guarda bien las gafas de sol!">
              <svg slot="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 10c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-3z"/><path d="M7 10c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-1.3-3-3-3z"/><path d="M12 2a7 7 0 0 0-2 13.5V18h4v-2.5A7 7 0 0 0 12 2z"/><path d="M9 18h6v4H9z"/></svg>
            </InfoPanel>
          </div>
        </div>

        <div class="w-full md:w-1/2 h-[500px] md:h-[600px] sticky top-24">
          <BentoItem title="The Sebali Resort" subtitle="Alojamiento de Lujo" href="https://www.booking.com/hotel/id/the-sebali-resort-ubud.es.html" class="h-full shadow-2xl shadow-amber-500/10">
            <img slot="image" src="/hoteles/Sebali.webp" alt="The Sebali Resort" loading="lazy" decoding="async" class="w-full h-full object-cover" />
          </BentoItem>
        </div>
      </section>

      <section class="flex flex-col md:flex-row-reverse items-center gap-12 md:gap-20 fade-in-on-scroll">
        <div class="w-full md:w-1/2 space-y-8">
          <div>
            <span class="text-amber-400 font-bold tracking-widest uppercase text-sm mb-2 block">25-27 JUL ¬∑ 2 NOCHES</span>
            <h2 class="text-4xl md:text-5xl font-[900] text-white mb-6 leading-tight">Villas y Acantilados üåä</h2>
            <p class="text-zinc-400 text-lg leading-relaxed mb-8">Bajamos al sur para estar en <strong>Uluwatu</strong>. Atardeceres espectaculares.</p>
          </div>
        </div>

        <div class="w-full md:w-1/2 h-[500px] md:h-[600px] sticky top-24">
          <BentoItem title="Hideaway Villas" subtitle="Vistas al Oc√©ano" href="https://www.booking.com/hotel/id/hideaway-villas-bali.es.html" class="h-full shadow-2xl shadow-amber-500/10">
            <img slot="image" src="/hoteles/Hideaway.webp" alt="Hideaway Villas Bali" loading="lazy" decoding="async" class="w-full h-full object-cover" />
          </BentoItem>
        </div>
      </section>

      <section class="flex flex-col md:flex-row items-center gap-12 md:gap-20">
        <div class="w-full md:w-1/2 space-y-8">
          <div>
            <span class="text-amber-400 font-bold tracking-widest uppercase text-sm mb-2 block">27-29 JUL ¬∑ 2 NOCHES</span>
            <h2 class="text-4xl md:text-5xl font-[900] text-white mb-6 leading-tight">Seminyak Chic üç∏</h2>
            <p class="text-zinc-400 text-lg leading-relaxed mb-8">En <strong>Montigo Resorts</strong> estamos en el epicentro de la moda Balinesa.</p>
          </div>
        </div>

        <div class="w-full md:w-1/2 h-[500px] md:h-[600px] sticky top-24">
          <BentoItem title="Montigo Resorts" subtitle="Zona de Moda" href="https://www.booking.com/hotel/id/montigo-resorts-seminyak.es.html" class="h-full shadow-2xl shadow-amber-500/10">
            <img slot="image" src="/hoteles/Montigo.webp" alt="Montigo Resorts Seminyak" loading="lazy" decoding="async" class="w-full h-full object-cover" />
          </BentoItem>
        </div>
      </section>

            <section class="flex flex-col md:flex-row-reverse items-center gap-12 md:gap-20 fade-in-on-scroll">
        <div class="w-full md:w-1/2 space-y-8">
          <div>
            <span class="text-amber-400 font-bold tracking-widest uppercase text-sm mb-2 block">29 JUL - 01 AGO ¬∑ 6 NOCHES</span>
            <h2 class="text-4xl md:text-5xl font-[900] text-white mb-6 leading-tight">FullMoon Party! üê¢</h2>
            <p class="text-zinc-400 text-lg leading-relaxed mb-8">Vivir como nunca la fiesta de la luna llena en <strong>Ponte Villas</strong></p>
          </div>
        </div>

        <div class="w-full md:w-1/2 h-[500px] md:h-[600px] sticky top-24">
          <BentoItem title="Ponte Villas" subtitle="Isla sin Coches" href="https://www.booking.com/hotel/id/ponte-villas.es.html" class="h-full shadow-2xl shadow-amber-500/10">
            <img slot="image" src="/hoteles/Ponte.webp" alt="Ponte Villas" loading="lazy" decoding="async" class="w-full h-full object-cover" />
          </BentoItem>
        </div>
      </section>

      <section class="flex flex-col md:flex-row-reverse items-center gap-12 md:gap-20 fade-in-on-scroll">
        <div class="w-full md:w-1/2 space-y-8">
          <div>
            <span class="text-amber-400 font-bold tracking-widest uppercase text-sm mb-2 block">01 AGO - 04 AGO ¬∑ 6 NOCHES</span>
            <h2 class="text-4xl md:text-5xl font-[900] text-white mb-6 leading-tight">Para√≠so Descalzo üê¢</h2>
            <p class="text-zinc-400 text-lg leading-relaxed mb-8">6 d√≠as en el <strong>Pearl of Trawangan</strong>. Sin coches, solo relax.</p>
          </div>
        </div>

        <div class="w-full md:w-1/2 h-[500px] md:h-[600px] sticky top-24">
          <BentoItem title="Pearl of Trawangan" subtitle="Isla sin Coches" href="https://www.booking.com/hotel/id/pearl-of-trawangan.es.html" class="h-full shadow-2xl shadow-amber-500/10">
            <img slot="image" src="/hoteles/Pearl.webp" alt="Pearl of Trawangan" loading="lazy" decoding="async" class="w-full h-full object-cover" />
          </BentoItem>
        </div>
      </section>

      <section class="flex flex-col md:flex-row items-center gap-12 md:gap-20">
        <div class="w-full md:w-1/2 space-y-8">
          <div>
            <span class="text-amber-400 font-bold tracking-widest uppercase text-sm mb-2 block">04-07 AGO ¬∑ 3 NOCHES</span>
            <h2 class="text-4xl md:text-5xl font-[900] text-white mb-6 leading-tight">Lombok Salvaje ü••</h2>
            <p class="text-zinc-400 text-lg leading-relaxed mb-8">Terminamos en <strong>Amber Lombok</strong>. Playas v√≠rgenes y paz total.</p>
          </div>
        </div>

        <div class="w-full md:w-1/2 h-[500px] md:h-[600px] sticky top-24">
          <BentoItem title="Amber Beach Resort" subtitle="Playa Virgen" href="https://www.booking.com/hotel/id/amber-beach-resort-lombok.es.html" class="h-full shadow-2xl shadow-amber-500/10">
            <img slot="image" src="/hoteles/Amber.webp" alt="Amber Beach Resort Lombok" loading="lazy" decoding="async" class="w-full h-full object-cover" />
          </BentoItem>
        </div>
      </section>

    </div>
  </div>

  <section class="relative z-20 max-w-4xl mx-auto px-4 mb-32 mt-10 fade-in-on-scroll">
    <div class="bg-zinc-900/80 backdrop-blur-2xl border border-white/10 rounded-[3.5rem] p-8 md:p-16 shadow-[0_0_50px_rgba(0,0,0,0.5)]">
      <div class="text-center mb-12">
        <h3 class="text-4xl md:text-5xl font-[900] text-white mb-4">Balimetro: üå¥</h3>
        <p class="text-amber-500/80 text-sm font-bold uppercase tracking-[0.3em]">An√°lisis de nuestra supervivencia</p>
      </div>

      <div class="space-y-10">
        <div class="group">
          <div class="flex justify-between items-end mb-3">
            <span class="text-white font-bold text-lg flex items-center gap-3">ü•• Relax <span class="text-zinc-500 text-xs font-normal italic">(Masajes y piscinas)</span></span>
            <span class="text-amber-400 font-black text-2xl">40%</span>
          </div>
          <div class="h-4 w-full bg-white/5 rounded-full p-1 border border-white/5">
            <div class="h-full bg-gradient-to-r from-amber-600 to-amber-300 rounded-full animate-grow-40 shadow-[0_0_15px_rgba(245,158,11,0.3)]"></div>
          </div>
        </div>

        <div class="group">
          <div class="flex justify-between items-end mb-3">
            <span class="text-white font-bold text-lg flex items-center gap-3">‚õ©Ô∏è Cultura <span class="text-zinc-500 text-xs font-normal italic">(Templos y ofrendas)</span></span>
            <span class="text-amber-400 font-black text-2xl">30%</span>
          </div>
          <div class="h-4 w-full bg-white/5 rounded-full p-1 border border-white/5">
            <div class="h-full bg-gradient-to-r from-amber-600 to-amber-300 rounded-full animate-grow-30 shadow-[0_0_15px_rgba(245,158,11,0.3)]"></div>
          </div>
        </div>

        <div class="group">
          <div class="flex justify-between items-end mb-3">
            <span class="text-white font-bold text-lg flex items-center gap-3">üåã Aventura <span class="text-zinc-500 text-xs font-normal italic">(Motos, buceo y trekking)</span></span>
            <span class="text-amber-400 font-black text-2xl">30%</span>
          </div>
          <div class="h-4 w-full bg-white/5 rounded-full p-1 border border-white/5">
            <div class="h-full bg-gradient-to-r from-amber-600 to-amber-300 rounded-full animate-grow-30 shadow-[0_0_15px_rgba(245,158,11,0.3)]"></div>
          </div>
        </div>

        <div class="pt-6">
          <div class="flex justify-between items-end mb-3">
            <span class="text-amber-400 font-black text-xl flex items-center gap-3 animate-pulse">üç∫ Cerveza Bintang <span class="text-amber-600 text-xs font-bold uppercase tracking-tighter">(INDISPENSABLE)</span></span>
            <span class="text-amber-400 font-black text-3xl">100%</span>
          </div>
          <div class="h-6 w-full bg-white/5 rounded-full p-1 border border-amber-500/30 overflow-hidden relative">
            <div class="h-full bg-gradient-to-r from-yellow-600 via-amber-400 to-yellow-600 rounded-full animate-grow-100 shadow-[0_0_30px_rgba(245,158,11,0.6)] relative overflow-hidden">
              <div class="absolute inset-0 bg-[linear-gradient(45deg,transparent_25%,rgba(255,255,255,0.2)_50%,transparent_75%)] bg-[length:250%_100%] animate-shimmer"></div>
            </div>
          </div>
        </div>
      </div>

      <p class="text-center text-zinc-500 text-xs mt-12 italic">Cualquier parecido con la realidad ser√° pura coincidencia (y mucha calor).</p>
    </div>
  </section>

  <section class="relative z-20 max-w-4xl mx-auto px-4 mb-16 mt-20">
    <ShareButtons />
  </section>

  <footer class="py-10 border-t border-white/10 text-center text-zinc-600 text-sm relative z-20">
    <p>B&S 2026 ‚Äî Indonesia nos espera.</p>
  </footer>

  <SchemaOrg type="WebSite" />
  <SchemaOrg type="Event" />
</Layout>

<style>
  /* Sustituto 1:1 de tus @apply (CSS puro, sin dramas) */
  .countdown-box {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
  }

  .countdown-box span:first-child {
    font-size: 1.875rem; /* text-3xl */
    line-height: 1;
    font-weight: 900;
    color: #ffffff;
    font-variant-numeric: tabular-nums;
  }

  @media (min-width: 768px) {
    .countdown-box span:first-child {
      font-size: 3rem; /* md:text-5xl */
    }
  }

  .countdown-box .label {
    margin-top: 0.5rem;
    font-size: 0.75rem; /* text-xs */
    line-height: 1;
    color: rgb(212, 212, 216); /* zinc-300 aprox */
    text-transform: uppercase;
    letter-spacing: 0.1em; /* tracking-widest */
    font-weight: 700;
  }

  @keyframes grow-40 { from { width: 0; } to { width: 40%; } }
  @keyframes grow-30 { from { width: 0; } to { width: 30%; } }
  @keyframes grow-100 { from { width: 0; } to { width: 100%; } }
  @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
  @keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  .animate-grow-40 { animation: grow-40 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards; }
  .animate-grow-30 { animation: grow-30 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards; }
  .animate-grow-100 { animation: grow-100 2.5s cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards; }
  .animate-shimmer { animation: shimmer 3s infinite linear; }
  .animate-fade-in { animation: fade-in 1s ease-out forwards; }
</style>

<script>
  // @ts-nocheck
  // --- CUENTA ATR√ÅS ---
  const weddingDate = new Date(2026, 6, 22, 0, 0, 0).getTime();

/** @type {ReturnType<typeof globalThis.setInterval> | null} */
let countdownTimer = null;
/** @type {ReturnType<typeof globalThis.setInterval> | null} */
let localTimeTimer = null;
/** @type {ReturnType<typeof globalThis.setInterval> | null} */
let weatherTimer = null;

  function updateCountdown() {
    const now = Date.now();
    const distance = weddingDate - now;
    const countdownEl = document.getElementById("countdown");
    if (!countdownEl) return;

    if (distance < 0) {
      countdownEl.innerHTML = "<div class='text-3xl text-center text-white font-bold col-span-4 p-8 bg-amber-600/80 rounded-2xl backdrop-blur-md shadow-2xl animate-bounce'>¬°ESTAMOS DE VIAJE! ‚úàÔ∏è</div>";
      return;
    }

    const dEl = document.getElementById("days");
    const hEl = document.getElementById("hours");
    const mEl = document.getElementById("minutes");
    const sEl = document.getElementById("seconds");

    if (dEl && hEl && mEl && sEl) {
      dEl.innerText = Math.floor(distance / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
      hEl.innerText = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
      mEl.innerText = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
      sEl.innerText = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');
    }
  }

  // --- CLIMA Y HORA EN UBUD ---
  async function updateWeather() {
    const tempEl = document.getElementById('weather-temp');
    const emojiEl = document.getElementById('weather-emoji');
    if (!tempEl || !emojiEl) return;

    // Mostrar loading state
    tempEl.innerText = "Cargando...";
    emojiEl.innerText = "üå°Ô∏è";

    try {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 8000); // 8s timeout
      
      const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=-8.5069&longitude=115.2625&current_weather=true', { 
        cache: "no-store",
        signal: controller.signal
      });
      
      clearTimeout(timeoutId);

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}`);
      }

      const data = await response.json();

      const temp = Math.round(data?.current_weather?.temperature);
      const code = Number(data?.current_weather?.weathercode);

      /** @type {Record<number, string>} */
      const emojis = { 0: "‚òÄÔ∏è", 1: "üå§Ô∏è", 2: "‚õÖ", 3: "‚òÅÔ∏è", 45: "üå´Ô∏è", 51: "üåßÔ∏è", 61: "üåßÔ∏è", 80: "üå¶Ô∏è", 95: "‚õàÔ∏è" };

      if (Number.isFinite(temp)) {
        tempEl.innerText = `${temp}¬∞C`;
        tempEl.setAttribute('aria-label', `Temperatura en Ubud: ${temp} grados Celsius`);
      } else {
        tempEl.innerText = "‚Äî";
      }
      emojiEl.innerText = (Object.prototype.hasOwnProperty.call(emojis, code) ? emojis[code] : "‚òÄÔ∏è");

    } catch (e) {
      // Error silencioso pero visible
      tempEl.innerText = "‚Äî";
      tempEl.setAttribute('aria-label', 'No se pudo cargar la temperatura');
      emojiEl.innerText = "üå°Ô∏è";
      console.warn('Error al cargar el clima:', e);
    }
  }

  function updateLocalTime() {
    const timeEl = document.getElementById('local-time');
    if (!timeEl) return;

    try {
      const timeStr = new Intl.DateTimeFormat("es-ES", {
        timeZone: 'Asia/Makassar',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      }).format(new Date());
      
      timeEl.innerText = timeStr;
      timeEl.setAttribute('aria-label', `Hora local en Bali: ${timeStr}`);
    } catch (e) {
      // Fallback si falla Intl
      const now = new Date();
      const baliTime = new Date(now.toLocaleString("en-US", {timeZone: "Asia/Makassar"}));
      const timeStr = baliTime.toLocaleTimeString("es-ES", { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
      timeEl.innerText = timeStr || "00:00:00";
    }
  }

  function cleanupHomeTimers() {
    if (countdownTimer) { clearInterval(countdownTimer); countdownTimer = null; }
    if (localTimeTimer) { clearInterval(localTimeTimer); localTimeTimer = null; }
    if (weatherTimer) { clearInterval(weatherTimer); weatherTimer = null; }
  }

  function initHomeWidgets() {
    // Si no estamos en esta p√°gina (por swaps raros), no hagas nada
    if (!document.getElementById("countdown")) return;

    // Evita duplicar timers al volver con el men√∫
    cleanupHomeTimers();

    // Inicializa ya
    updateCountdown();
    updateLocalTime();
    updateWeather();

    // Timers
    countdownTimer = setInterval(updateCountdown, 1000);
    localTimeTimer = setInterval(updateLocalTime, 1000);

    // Clima: no cada segundo, que no eres AEMET. Cada 10 min sobra.
    weatherTimer = setInterval(updateWeather, 10 * 60 * 1000);
  }

  // Carga normal + navegaci√≥n Astro (sin F5)
  document.addEventListener("DOMContentLoaded", initHomeWidgets);
  document.addEventListener("astro:page-load", initHomeWidgets);

  // Limpieza antes de salir (evita que se acumulen intervalos)
  document.addEventListener("astro:before-swap", cleanupHomeTimers);
</script>
